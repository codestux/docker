services:
  tux:
    image: carandre/linuxtips-tux-senhas:1.0
    ports:
      - "5000:5000"
    container_name: tux-senhas-container
    networks:
      - tux
    environment:
      REDIS_HOST: redis
    env_files:
      - .env
    volumes:
      - type: volume
        source: tux
        target: /tux
    depends_on:
      - redis
    deploy:
      replicas: 3
      labels:
        br.com.codestream.description: "Codestream Tecnol√≥gica"
        br.com.codestream.version: "1.0"
      update_config:
        parallelism: 2
        delay: 5s
      resources:
        reservations:
          cpus: 0.3
          memory: 80MB
        limits:
          cpus: 0.7
          memory: 30MB

  redis:
    image: carandre/linuxtips-redis:1.0
    networks:
      - tux
    volumes:
      - tux:/tux

networks:
  tux:
    driver: bridge

volumes:
  tux:
